<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Humanity Clicker</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Start Menu -->
    <div id="start-menu">
        <h1 id="title">Humanity Clicker</h1>
        <button id="start-button">Praise to the Gods!</button>
    </div>
    
    <!-- Main Game Container -->
    <div id="game-container">
        <div id="main-game">
            <div id="background"></div>
            <div id="click-area">
                <div id="click-ripple"></div>
            </div>
            <div id="particles"></div>
            <div id="medals"></div>
        </div>
        <div id="upgrade-panel">
            <h2 id="era-title">Stone Age</h2>
            <p id="era-description">Harsh winters and predators force adaptation.</p>
            <div id="upgrades"></div>
        </div>
        <div id="alert"></div>
        <button id="next-era">Advance to Next Era</button>
        <button id="skip-era">Skip Era</button>
    </div>
    
    <!-- Score Display -->
    <div id="score">Points: <span>0.0</span><div class="glowing-text">+0.0/s</div></div>
    
    <!-- Modals -->
    <div id="choiceModal">
        <p id="narrative"></p>
        <button id="choice1"></button>
        <button id="choice2"></button>
    </div>
    
    <div id="randomDilemmaModal">
        <h3>Event!</h3>
        <p id="dilemma-text"></p>
        <button id="dilemma-choice1"></button>
        <button id="dilemma-choice2"></button>
    </div>
    
    <div id="mysteriousWindow">The gods will remember that.</div>
    
    <div id="welcomeModal">
        <p>Welcome to Humanity Clicker!</p>
        <p>Your goal is to advance through the ages of humanity by earning points and making strategic decisions.</p>
        <p>Click the central area to earn points and buy upgrades to increase your points per click and passive points per second.</p>
        <p>Each era presents a dilemma that will test your decision-making skills. Choose wisely to earn medals and advance to the next era.</p>
        <p>Beware of random events that will test your leadership throughout each era!</p>
        <p>Good luck, and may the gods of humanity guide your choices!</p>
        <button id="close-welcome-modal">Praise to the Gods!</button>
    </div>
    
    <!-- Define critical variables first -->
    <script>
    // Core game variables that need to be defined before other scripts load
    let points = 0.0;
    let baseClickValue = 1.0;
    let upgradeClickValue = 0.0;
    let currentEra = 0;
    let medals = [];
    let passivePoints = 0.0;
    let passiveInterval = null;
    let lastRandomEventTime = 0;
    
    // Helper function references that might be needed across files
    function updateGlowingText() {
        if (passivePoints > 0) {
            const glowingText = document.querySelector(".glowing-text");
            glowingText.textContent = `+${passivePoints.toFixed(1)}/s`;
            glowingText.style.animation = "fadeOut 1s ease-out forwards, moveUp 1s ease-out forwards";
            setTimeout(() => {
                glowingText.style.animation = "";
            }, 1000);
        }
    }
    
    function setupPassivePoints() {
        if (passivePoints > 0) {
            if (passiveInterval) {
                clearInterval(passiveInterval);
            }
            passiveInterval = setInterval(() => {
                points += passivePoints;
                updateScore(true);
                updateGlowingText();
            }, 1000);
        }
    }
    
    function showAlert(message) {
        const alertBox = document.getElementById('alert');
        alertBox.innerText = message;
        alertBox.style.display = 'block';
        setTimeout(() => {
            alertBox.style.display = 'none';
        }, 3000);
    }
    
    function showNotification(message) {
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.textContent = message;
        document.body.appendChild(notification);
        
        setTimeout(() => {
            if (document.body.contains(notification)) {
                document.body.removeChild(notification);
            }
        }, 4000);
    }
    
    function updateScore(isPassive = false) {
        const scoreElement = document.getElementById("score").querySelector("span");
        scoreElement.textContent = points.toFixed(1);
        if (isPassive) {
            scoreElement.style.animation = "flashGreen 0.5s ease-in-out";
            scoreElement.addEventListener("animationend", () => {
                scoreElement.style.animation = "";
            }, { once: true });
        }
    }
    </script>
    
    <!-- Load JavaScript files in the correct order -->
    <script src="game-data.js"></script>
    <script src="game-core.js"></script>
    <script src="visual-effects.js"></script>
    <script src="random-events.js"></script>
</body>
</html>
